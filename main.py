def extract_strings(file_path, malstg):
    try:
        with open(r"C:\Users\Options\Desktop\Screenshot (74).png", 'rb') as file:
            data = file.read()

            # Iterate through the data and find ASCII strings
            current_string = ''
            for byte in data:
                if 32 <= byte <= 126 or byte == 10 or byte == 13:
                    # ASCII printable characters or newline/return characters
                    current_string += chr(byte)
                else:
                    # Non-printable character, print the current string if it's not empty
                    if current_string:
                        print(current_string, end="")
                        for str in malstg:
                            if str in current_string:
                                print(" -> This is string is malicious")
                                break
                        print()
                        current_string = ''

            # Print the last string if it's not empty
            if current_string:
                print(current_string)

    except Exception as e:
        print(f"Error: {e}")


# Example usage
Malware_list = ["IHDR","Add-Type", "AddSecurityPackage", "AdjustTokenPrivileges", "AllocHGlobal", "BindingFlags", "Bypass",
                "CloseHandle", "CreateDecryptor", "CreateEncryptor", "CreateProcessWithToken", "CreateRemoteThread",
                "CreateThread",
                "CreateType", "CreateUserThread", "Cryptography", "CryptoServiceProvider", "CryptoStream",
                "DangerousGetHandle",
                "DeclaringMethod", "DeclaringType", "DefineConstructor", "DefineDynamicAssembly", "DefineDynamicModule",
                "DefineEnum",
                "DefineField", "DefineLiteral", "DefinePInvokeMethod", "DefineType", "DeflateStream", "DeviceIoControl",
                "DllImport",
                "DuplicateTokenEx", "Emit", "EncodedCommand", "EnumerateSecurityPackages", "ExpandString",
                "FreeHGlobal", "FreeLibrary",
                "FromBase64String", "GetAssemblies", "GetAsyncKeyState", "GetConstructor", "GetConstructors",
                "GetDefaultMembers",
                "GetDelegateForFunctionPointer", "GetEvent", "GetEvents", "GetField", "GetFields",
                "GetForegroundWindow", "GetInterface",
                "GetInterfaceMap", "GetInterfaces", "GetKeyboardState", "GetLogonSessionData", "GetMember",
                "GetMembers", "GetMethod",
                "GetMethods", "GetModuleHandle", "GetNestedType", "GetNestedTypes", "GetPowerShell", "GetProcAddress",
                "GetProcessHandle",
                "GetProperties", "GetProperty", "GetTokenInformation", "GetTypes", "ILGenerator",
                "ImpersonateLoggedOnUser",
                "InteropServices", "IntPtr", "InvokeMember", "kernel32", "LoadLibrary", "LogPipelineExecutionDetails",
                "MakeArrayType",
                "MakeByRefType", "MakeGenericType", "MakePointerType", "Marshal", "memcpy", "MemoryStream", "Methods",
                "MiniDumpWriteDump",
                "NonPublic", "OpenDesktop", "OpenProcess", "OpenProcessToken", "OpenThreadToken", "OpenWindowStation",
                "PasswordDeriveBytes", "Properties", "ProtectedEventLogging", "PtrToString", "PtrToStructure",
                "ReadProcessMemory",
                "ReflectedType", "RevertToSelf", "RijndaelManaged", "ScriptBlockLogging", "SetInformationProcess",
                "SetThreadToken",
                "SHA1Managed", "StructureToPtr", "ToBase64String", "TransformFinalBlock", "TypeHandle",
                "TypeInitializer",
                "UnderlyingSystemType", "UnverifiableCodeAttribute", "VirtualAlloc", "VirtualFree", "VirtualProtect",
                "WriteByte",
                "WriteInt32", "WriteProcessMemory", "ZeroFreeGlobalAllocUnicode"]

file_path = "C:\\Users\\Options\\Desktop\\Screenshot (65).png"
extract_strings(file_path, Malware_list)
